# 🔒 環境変数セキュリティガイド

## 🚨 緊急対応が必要な場合

### API キーが漏洩した場合の対処手順

1. **即座に API キーを無効化**
   - Google Cloud Console にアクセス
   - 該当の API キーを削除または無効化
   - EmailJS コンソールで該当プロジェクトのキーを再生成

2. **新しい API キーの生成**
   - Google Maps API キーを新規作成
   - 適切なリファラー制限を設定
   - 最小限のスコープのみ許可

3. **Git の履歴から削除**

   ```bash
   # 機密情報を含むコミットを履歴から削除
   git filter-branch --force --index-filter \
     'git rm --cached --ignore-unmatch .env' \
     --prune-empty --tag-name-filter cat -- --all
   ```

## ✅ セキュアな環境変数設定

### 開発環境

- `.env.local` を使用（Git に含まれない）
- 開発専用の API キーを使用
- 定期的なキーローテーション

### 本番環境

- GitHub Secrets の使用
- 環境変数による設定
- CI/CD パイプラインでの安全な値注入

### ステージング環境

- 本番とは別の API キーを使用
- 制限されたスコープ設定
- テスト用データソースの使用

## 🛡️ ベストプラクティス

### API キー管理

- キーごとに適切なスコープ制限
- IP アドレス・ドメイン制限の設定
- 使用量監視とアラート設定
- 定期的なキーローテーション

### コード管理

- `.env` ファイルはテンプレートのみ
- 実際の値は `.env.local` に保存
- 機密情報の絶対的な Git 除外

### チーム開発

- API キーの共有方法の標準化
- セキュアなキー配布プロセス
- 開発者別のキー使用（可能な場合）

## 📋 チェックリスト

### 開発者オンボーディング

- [ ] `.env.local` ファイルの作成
- [ ] 必要な API キーの取得・設定
- [ ] キー制限設定の確認
- [ ] セキュリティガイドラインの理解

### リリース前チェック

- [ ] `.env` に実際のキーが含まれていないか
- [ ] `.gitignore` が適切に設定されているか
- [ ] 本番用キーが適切に設定されているか
- [ ] 不要なキーが削除されているか

### 定期メンテナンス

- [ ] API キーの使用量確認
- [ ] 不要になったキーの削除
- [ ] キーの定期ローテーション
- [ ] セキュリティログの確認
